<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CGPA Result</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="container mt-4 text-center">
        <div id="resultBox" class="p-4 border rounded shadow-sm bg-light">
            <h2 class="mb-3">Your CGPA is: <span class="text-success">{{ cgpa }}</span></h2>
            <p>Total Credits Considered: <strong>{{ total_credits }}</strong></p>
            <hr>
            <h4>Subjects:</h4>
            <ul class="list-group">
                {% for grade, credit in subjects %}
                    <li class="list-group-item">Grade: {{ grade }} | Credits: {{ credit }}</li>
                {% endfor %}
            </ul>
        </div>

        <div class="mt-4">
            <a href="/" class="btn btn-secondary">Calculate Again</a>
            <button onclick="window.print()" class="btn btn-info">ðŸ–¨ Print</button>
            <button id="downloadPdf" class="btn btn-success">ðŸ“„ Download PDF</button>
            <button id="sharePdf" class="btn btn-warning">ðŸ“¤ Share PDF</button>
        </div>
    </div>

    <script>
        document.getElementById("downloadPdf").addEventListener("click", function () {
            const element = document.getElementById("resultBox");
            html2pdf().from(element).save("CGPA_Result.pdf");
        });

        document.getElementById("sharePdf").addEventListener("click", async function () {
            const element = document.getElementById("resultBox");
            const pdfBlob = await html2pdf().from(element).outputPdf('blob');

            if (navigator.share) {
                const file = new File([pdfBlob], "CGPA_Result.pdf", { type: "application/pdf" });
                navigator.share({
                    title: "CGPA Result",
                    text: "Here is my CGPA calculation.",
                    files: [file]
                }).catch(err => console.log("Sharing failed", err));
            } else {
                alert("Sharing not supported in this browser.");
            }
        });
    </script>
</body>
</html>
